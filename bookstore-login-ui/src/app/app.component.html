<style>

/* HEADER */
.header {
  color: snow;
  font-weight: bold;
  background: darkorange;
  height: 45px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 15px;
}

/* Cart Section */
.cart-area {
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  position: relative;
  color: whitesmoke;
}

.cart-label {
  font-size: medium;
  font-weight: bold;
}

.cart-badge {
  background: red;
  color: white;
  font-size: 12px;
  border-radius: 50%;
  padding: 2px 6px;
  font-weight: bold;
  position: absolute;
  top: -8px;
  right: -10px;
}

/* Main Login UI */
.login-container {
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(10px);
  padding: 3rem 4rem;
  border-radius: 16px;
  text-align: center;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  min-width: 300px;
}

h1 {
  margin-bottom: 2rem;
  color: #fff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.5);
  font-size: 2rem;
}

.login-btn {
  background: linear-gradient(90deg, #FF6B6B, #FF3BFF);
  color: white;
  border: none;
  padding: 0.75rem 2rem;
  border-radius: 50px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.login-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 15px rgba(0,0,0,0.3);
}

/* Book Grid */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 20px;
  padding: 20px;
}

/* Book Card */
.card {
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0px 2px 6px #00000022;
  text-align: center;
}

.card img {
  width: 100%;
  height: 250px;
  object-fit: cover;
  border-radius: 8px;
}

.card button {
  width: 100%;
  background: darkorange;
  color: white;
  font-weight: bold;
  border: none;
  padding: 8px;
  border-radius: 6px;
  cursor: pointer;
}

.card button:disabled {
  background: gray;
  cursor: not-allowed;
}

.added-btn {
  background: gray !important;
  cursor: not-allowed !important;
}

body {
  background: url('https://images.unsplash.com/photo-1519682577862-22b62b24e493?auto=format&fit=crop&w=1350&q=80') 
    no-repeat center center fixed;
  background-size: cover;
  height: 100vh;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}

</style>

<!-- LOGIN PAGE -->
<div *ngIf="!name" class="login-container">
  <h1>Welcome To BookStore</h1>
  <button class="login-btn" (click)="loginWithGoogle()">Login</button>
</div>

<!-- DASHBOARD -->
<div *ngIf="name" class="dashboard-container">

  <!-- HEADER -->
  <h3 class="header">
    <span>Welcome, {{ name }}!</span>

    <span class="cart-area" (click)="toggleCart()">
      <span class="material-icons">shopping_cart</span>
      <span class="cart-label">Your Cart</span>

      <!-- Cart count -->
      <span *ngIf="cartCount > 0" class="cart-badge">{{ cartCount }}</span>
    </span>
  </h3>

  <!-- BOOK LIST (when NOT viewing cart) -->
  <div *ngIf="!showCart" class="grid">

    <div class="card" *ngFor="let book of books">
      <img [src]="book.image_url" alt="Book Image">
      <h3>{{ book.title }}</h3>
      <p>{{ book.authors }}</p>

      <button 
        (click)="addToCart(book)"
        [disabled]="addedBooks.includes(book.book_id)"
      >
        {{ addedBooks.includes(book.book_id) ? 'Added to Cart' : 'Add to Cart' }}
      </button>
    </div>

  </div>

  <!-- CART VIEW -->
  <div *ngIf="showCart" class="grid">

    <div class="card" *ngFor="let item of allAddedBooks">
      <img [src]="item.image_url" alt="Book Image">
      <h3>{{ item.title }}</h3>
      <p>{{ item.authors }}</p>

      <button disabled class="added-btn">Added</button>
    </div>

  </div>

  <!-- â­ BUY NOW BUTTON (Added Without Changing Anything Else) -->
  <div *ngIf="showCart" style="text-align:center; margin-bottom: 25px;">
    <button 
      style="
        background: green;
        color: white;
        padding: 12px 30px;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        font-weight: bold;
      "
      (click)="buyBooks()"
    >
      Buy Now
    </button>
  </div>

</div>
